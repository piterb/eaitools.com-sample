$.fn.icdph=function(){var f="https://api.eaitools.com";function d(i,k){var j=k.name+" ("+k.id_number+")";if(k.city!=null&&k.city.length>0){j+=" - "+k.city}return $("<li>").append('<div class="ui-menu-item-wrapper">'+j+"</div>").appendTo(i)}function h(j,k,m,l){var i=m.attr("data-icdph-form");$(m).val(k.item[i]);$(m).addClass("ui-autocomplete-loading");$.ajax({url:f+"/icdph/organization/view",dataType:"jsonp",data:{id:k.item.rpoid,"access-token":l},success:function(n){if("name" in n){$(e).find('input[data-icdph-form="name"]').val(n.name);$(e).find('input[data-icdph-form="id_number"]').val(n.id_number);$(e).find('input[data-icdph-form="tax_number"]').val(n.tax_number);$(e).find('input[data-icdph-form="vat_number"]').val(n.vat_number);$(e).find('input[data-icdph-form="address"]').val(n.address);if(n.address){$(e).find('input[data-icdph-form="address_full"]').val(n.address+", "+n.postal_code+" "+n.city)}else{$(e).find('input[data-icdph-form="address_full"]').val(n.postal_code+" "+n.city)}$(e).find('input[data-icdph-form="city"]').val(n.city);$(e).find('input[data-icdph-form="postal_code"]').val(n.postal_code);$(e).find('input[data-icdph-form="registry_name"]').val(n.registry_name);$(e).find('input[data-icdph-form="registry_id"]').val(n.registry_id);$(e).find('input[data-icdph-form="registry_full"]').val(n.registry_name+", "+n.registry_id)}}}).always(function(){$(m).removeClass("ui-autocomplete-loading")});j.preventDefault()}var c=$('script[src*="icdph"]').attr("src").match(/access-token=([A-Za-z0-9\-]+)/);if(c!=null&&c.length>=2&&c[0].indexOf("access-token")==0){var g=c[1]}else{console.error("Script must be called with access-token query parameter.")}var e=this;$(e).addClass("icdph-form");var b=$(this).find('input[data-icdph-form="name"]');var a=$(this).find('input[data-icdph-form="id_number"]');$(b).autocomplete({source:function(j,i){$.ajax({url:f+"/icdph/organization/search",dataType:"jsonp",data:{term:j.term,"access-token":g},success:function(k){i(k)}})},minLength:3,focus:function(i,j){$(b).val(j.item.name);return false},select:function(i,j){return h(i,j,b,g)}}).autocomplete("instance")._renderItem=function(i,j){return d(i,j)};$(a).autocomplete({source:function(j,i){$.ajax({url:f+"/icdph/organization/search-ico",dataType:"jsonp",data:{ico:j.term,"access-token":g},success:function(k){i(k)}})},minLength:8,focus:function(i,j){$(a).val(j.item.id_number);return false},select:function(i,j){return h(i,j,a,g)}}).autocomplete("instance")._renderItem=function(i,j){return d(i,j)}};